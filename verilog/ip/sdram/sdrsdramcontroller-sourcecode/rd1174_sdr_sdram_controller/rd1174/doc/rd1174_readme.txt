                   SDR SDRAM Controller Reference Design                          
===============================================================================
File List
 
 1. rd1174/doc/rd1174.pdf            	        								--> SDR SDRAM Controller Reference Design document
    rd1174/doc/rd1174_readme.txt                        						--> Read me file (this file)    
	rd1174/doc/revision_history													--> Revision History 
	
 2.	
   	rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_syn.ldf		  			--> Lattice Diamond project file  		(synplify)
    rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_syn.lpf       			--> preference file  					(synplify)           
    rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_syn1.sty      			--> strategy file						(synplify)
					
	rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_syn.ldf		  			--> Lattice Diamond project file  		(synplify)
    rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_syn.lpf       			--> preference file  					(synplify)           
    rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_syn1.sty      			--> strategy file						(synplify)
					
	rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_syn.ldf		  			--> Lattice Diamond project file  		(synplify)
    rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_syn.lpf       			--> preference file  					(synplify)           
    rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_syn1.sty      			--> strategy file						(synplify)
					
	rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_syn.ldf	  			--> Lattice Diamond project file  		(synplify)
    rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_syn.lpf      			--> preference file  					(synplify)           
    rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_syn1.sty     			--> strategy file						(synplify)
					
	rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_syn.ldf	  			--> Lattice Diamond project file  		(synplify)
    rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_syn.lpf      			--> preference file  					(synplify)           
    rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_syn1.sty     			--> strategy file						(synplify)
					
	rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_lse.ldf		  			--> Lattice Diamond project file  		(LSE)
    rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_lse.lpf       			--> preference file  					(LSE)           
    rd1174/project/xo3l/verilog/micron4m32/xo3l_verilog_lse1.sty      			--> strategy file						(LSE)
					
	rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_lse.ldf		  			--> Lattice Diamond project file  		(LSE)
    rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_lse.lpf       			--> preference file  					(LSE)           
    rd1174/project/xo3l/verilog/micron8m16/xo3l_verilog_lse1.sty      			--> strategy file						(LSE)
					
	rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_lse.ldf		  			--> Lattice Diamond project file  		(LSE)
    rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_lse.lpf       			--> preference file  					(LSE)           
    rd1174/project/xo3l/verilog/micron16m8/xo3l_verilog_lse1.sty      			--> strategy file						(LSE)
					
	rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_lse.ldf	  			--> Lattice Diamond project file  		(LSE)
    rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_lse.lpf      			--> preference file  					(LSE)           
    rd1174/project/xo3l/verilog/micron16m16/xo3l_verilog_lse1.sty     			--> strategy file						(LSE)
					
	rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_lse.ldf	  			--> Lattice Diamond project file  		(LSE)
    rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_lse.lpf      			--> preference file  					(LSE)           
    rd1174/project/xo3l/verilog/micron128m4/xo3l_verilog_lse1.sty     			--> strategy file						(LSE)	
	


 3. /rd1174/simulation/xo3l/verilog/micron4m32_rtl_verilog.do		     		--> verilog rtl simulation script  	
    /rd1174/simulation/xo3l/verilog/micron4m32_timing_verilog_syn.do	 		--> verilog timing simulation script 	(synplify)
	/rd1174/simulation/xo3l/verilog/micron4m32_timing_verilog_lse.do	 		--> verilog timing simulation script  	(LSE)	
	
	/rd1174/simulation/xo3l/verilog/micron8m16_rtl_verilog.do		     		--> verilog rtl simulation script  	
    /rd1174/simulation/xo3l/verilog/micron8m16_timing_verilog_syn.do	 		--> verilog timing simulation script 	(synplify)
	/rd1174/simulation/xo3l/verilog/micron8m16_timing_verilog_lse.do	 		--> verilog timing simulation script  	(LSE)

	/rd1174/simulation/xo3l/verilog/micron16m8_rtl_verilog.do		     		--> verilog rtl simulation script  	
    /rd1174/simulation/xo3l/verilog/micron16m8_timing_verilog_syn.do	 		--> verilog timing simulation script 	(synplify)
	/rd1174/simulation/xo3l/verilog/micron16m8_timing_verilog_lse.do	 		--> verilog timing simulation script  	(LSE)	

	/rd1174/simulation/xo3l/verilog/micron16m16_rtl_verilog.do		     		--> verilog rtl simulation script  	
    /rd1174/simulation/xo3l/verilog/micron16m16_timing_verilog_syn.do	 		--> verilog timing simulation script 	(synplify)
	/rd1174/simulation/xo3l/verilog/micron16m16_timing_verilog_lse.do	 		--> verilog timing simulation script  	(LSE)		
	
	/rd1174/simulation/xo3l/verilog/micron128m4_rtl_verilog.do		     		--> verilog rtl simulation script  	
    /rd1174/simulation/xo3l/verilog/micron128m4_timing_verilog_syn.do	 		--> verilog timing simulation script 	(synplify)
	/rd1174/simulation/xo3l/verilog/micron128m4_timing_verilog_lse.do	 		--> verilog timing simulation script  	(LSE)		
	

	
 4. rd1174/source/verilog/micron4m32/autorefresh_counter              		    --> source file 
	rd1174/source/verilog/micron4m32/delay_gen150us                   			--> source file 
	rd1174/source/verilog/micron4m32/lfsr_count255                   			--> source file 
	rd1174/source/verilog/micron4m32/lfsr_count64                 				--> source file 
	rd1174/source/verilog/micron4m32/sdram_control_fsm                    		--> source file 
	rd1174/source/verilog/micron4m32/sdram_controller                    		--> source file 
	rd1174/source/verilog/micron4m32/sdram_defines                   			--> source file 
   
	rd1174/source/verilog/micron8m16/autorefresh_counter                    	--> source file 
	rd1174/source/verilog/micron8m16/delay_gen150us                    			--> source file 
	rd1174/source/verilog/micron8m16/lfsr_count255                    			--> source file 
	rd1174/source/verilog/micron8m16/lfsr_count64                    			--> source file 
	rd1174/source/verilog/micron8m16/sdram_control_fsm                   	 	--> source file 
	rd1174/source/verilog/micron8m16/sdram_controller                    		--> source file 
	rd1174/source/verilog/micron8m16/sdram_defines                    			--> source file
   
	rd1174/source/verilog/micron16m8/autorefresh_counter                   		--> source file 
	rd1174/source/verilog/micron16m8/delay_gen150us                    			--> source file 
	rd1174/source/verilog/micron16m8/lfsr_count255                    			--> source file 
	rd1174/source/verilog/micron16m8/lfsr_count64                    			--> source file 
	rd1174/source/verilog/micron16m8/sdram_control_fsm                   		--> source file 
	rd1174/source/verilog/micron16m8/sdram_controller                   		--> source file 
	rd1174/source/verilog/micron16m8/sdram_defines                    			--> source file
   
    rd1174/source/verilog/micron16m16/autorefresh_counter                     	--> source file 
	rd1174/source/verilog/micron16m16/delay_gen150us                    		--> source file 
	rd1174/source/verilog/micron16m16/lfsr_count255                   			--> source file 
	rd1174/source/verilog/micron16m16/lfsr_count64                    			--> source file 
	rd1174/source/verilog/micron16m16/sdram_control_fsm                    		--> source file 
	rd1174/source/verilog/micron16m16/sdram_controller                    		--> source file 
	rd1174/source/verilog/micron16m16/sdram_defines                    			--> source file
   
    rd1174/source/verilog/micron128m4/autorefresh_counter                     	--> source file 
	rd1174/source/verilog/micron128m4/delay_gen150us                    		--> source file 
	rd1174/source/verilog/micron128m4/lfsr_count255                    			--> source file 
	rd1174/source/verilog/micron128m4/lfsr_count64                    			--> source file 
	rd1174/source/verilog/micron128m4/sdram_control_fsm                    		--> source file 
	rd1174/source/verilog/micron128m4/sdram_controller                   		--> source file 
	rd1174/source/verilog/micron128m4/sdram_defines                    			--> source file
	
   
	
 5. rd1174/testbench/verilog/micron4m32/mt48lc4m32b2                    		--> testbench file 
	rd1174/testbench/verilog/micron4m32/sdr_sdram_controller_wrapper            --> testbench file 
	rd1174/testbench/verilog/micron4m32/sdr_sdram_controller_wrapper_synth      --> testbench file 
	rd1174/testbench/verilog/micron4m32/sdram_controller_tb                    	--> testbench file 
	rd1174/testbench/verilog/micron4m32/sdram_defines                    		--> testbench file 
    
	rd1174/testbench/verilog/micron8m16/mt48lc8m16a2                    		--> testbench file 
	rd1174/testbench/verilog/micron8m16/sdr_sdram_controller_wrapper            --> testbench file 
	rd1174/testbench/verilog/micron8m16/sdr_sdram_controller_wrapper_synth      --> testbench file 
	rd1174/testbench/verilog/micron8m16/sdram_controller_tb                    	--> testbench file 
	rd1174/testbench/verilog/micron8m16/sdram_defines                    		--> testbench file 
   
   	rd1174/testbench/verilog/micron16m8/mt48lc16m8a2                    		--> testbench file 
	rd1174/testbench/verilog/micron16m8/sdr_sdram_controller_wrapper            --> testbench file 
	rd1174/testbench/verilog/micron16m8/sdr_sdram_controller_wrapper_synth      --> testbench file 
	rd1174/testbench/verilog/micron16m8/sdram_controller_tb                    	--> testbench file 
	rd1174/testbench/verilog/micron16m8/sdram_defines                    		--> testbench file
   
    rd1174/testbench/verilog/micron16m16/mt48lc16m16a2                    		--> testbench file 
	rd1174/testbench/verilog/micron16m16/sdr_sdram_controller_wrapper           --> testbench file 
	rd1174/testbench/verilog/micron16m16/sdr_sdram_controller_wrapper_synth     --> testbench file 
	rd1174/testbench/verilog/micron16m16/sdram_controller_tb                    --> testbench file 
	rd1174/testbench/verilog/micron16m16/sdram_defines                    		--> testbench file
   
    rd1174/testbench/verilog/micron128m4/mt48lc128m4a2                    		--> testbench file 
	rd1174/testbench/verilog/micron128m4/sdr_sdram_controller_wrapper           --> testbench file 
	rd1174/testbench/verilog/micron128m4/sdr_sdram_controller_wrapper_synth     --> testbench file 
	rd1174/testbench/verilog/micron128m4/sdram_controller_tb                    --> testbench file 
	rd1174/testbench/verilog/micron128m4/sdram_defines                    		--> testbench file
  
  6.
	rd1174/constraints/sdram_controller_pcf_sbt.pcf
    rd1174/constraints/sdram_controller_syn.sdc
    
===================================================================================================  
!!IMPORTANT NOTES:!!
1. Unzip the rd1174_revyy.y.zip file using the existing folder names, where yy.y is the current
   version of the zip file
2. If there is lpf file or lci file available for the reference design:
	2.1 copy the content of the provided lpf file to the <project_name>.lpf file under your ispLEVER project, 
	2.2 use Constraint Files >> Add >> Exiting File to import the lpf to Diamond project and set it to be active,
	2.3 copy the content of the provided lct file to the <project_name>.lct under your cpld project.  
4. If there is sty file (strategy file for Diamond) available for the design, go to File List tab on the left 
   side of the GUI. Right click on Strategies >> Add >> Existing File. Then right click on the imported file 
   name and select "Set as Active Strategy".

===================================================================================================  
   
===================================================================================================  
Using Diamond Software
---------------------------------------------------------------------------------------------------  
HOW TO CREATE A PROJECT IN DIAMOND:
1. Launch Diamond software, in the GUI, select File >> New Project, click Next
2. In the New Project popup, select the Project location and provide a Project name and implementation 
   name, click Next.
3. Add the necessary source files from the rd1174\source directory, click Next
4. Select the desired part and speedgrade. You may use rd1174.pdf to see which device and speedgrade 
   can be selected to achieve the published timing result 
5. Click Finish. Now the project is successfully created. 
6. MAKE SURE the provided lpf and/or sty files are used in the current directory. 
     
----------------------------------------------------------------------------------------------------      
HOW TO RUN SIMULATION UNDER DIAMOND:
1. Bring up the Simulation Wizard under the Tools menu 
2. Next provide a name for simulation project, and select RTL or post-route simulation
	2.1 For post-route simulation, must export verilog or vhdl simulation file after Place and Route
3. Next add the test bench files form the rd1174\TestBench directory 
	3.1 For VHDL, make sure the top-level test bench is last to be added
4. Next click Finish, this will bring up the Aldec simulator automatically
5. In Aldec environment, you can manually activate the simulation or you can use a script
	5.1 Use the provided script in the rd1174\simulation\<device_family>\<language> directory
		a. For functional simulation, change the library name to the device family
			i) MachXO3L: ovi_machxo3l for verilog, machxo3l for vhdl.

		b. For POST-ROUTE simulation, open the script and change the following:
			i) The sdf file name and the path pointing to your sdf file.
			   The path usually looks like "./<implementation_name>/<sdf_file_name>.sdf"
		   ii) Change the library name using the library name described above
		c. Click Tools > Execute Macro and select the xxx.do file to run the simulation
		d. This will run the simulation until finish
		
	5.2 Manually activate the simulation
		a. Click Simulation > Initialize Simulation
		b. Click File > New > Waveform, this will bring up the Waveform panel
		c. Click on the top-level testbench, drag all the signals into the Waveform panel
		d. At the Console panel, type "run -all" for Verilog simulation
		e. For timing simulation, you must manually add 
		   -sdfmax sdram_controller_tb_u1/sdram_controller_u1/sdram_controller_u1/ = "../micron4m32_xo3l_verilog_syn_vo.sdf"
		   into the asim or vsim command. Use the command in timing_xxx.do as an example
6. The simulation result will be, as below. 
----------------------------------------------------------------------------------------------------      
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  160810.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  160890.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  160970.0 ns LMR  : Load Mode Register
# KERNEL: sdram_controller_tb.sim_model_u2 :                             CAS Latency      = 2
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Burst Length     = 1
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Burst Type       = Sequential
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Write Burst Mode = Programmed Burst Length
# KERNEL: Initialization is completed              161080
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  161080.0 ns LMR  : Load Mode Register
# KERNEL: sdram_controller_tb.sim_model_u2 :                             CAS Latency      = 2
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Burst Length     = 1
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Burst Type       = Sequential
# KERNEL: sdram_controller_tb.sim_model_u2 :                             Write Burst Mode = Programmed Burst Length
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  161130.0 ns ACT  : Bank = 0 Row =    8
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  161160.0 ns WRITE: Bank = 0 Row =    8, Col =   0, Data =     0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  161180.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: Writing is completed              161230
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176050.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176150.0 ns ACT  : Bank = 0 Row =    8
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176196.0 ns READ : Bank = 0 Row =    8, Col =   0, Data =     0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176200.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: Reading is completed              176210
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176240.0 ns ACT  : Bank = 0 Row =   32
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176270.0 ns WRITE: Bank = 0 Row =   32, Col =   0, Data =   256
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  176290.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  191050.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  191150.0 ns ACT  : Bank = 0 Row =   64
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  191180.0 ns WRITE: Bank = 0 Row =   64, Col =   0, Data =   512
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  191200.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206050.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206150.0 ns ACT  : Bank = 0 Row =   32
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206196.0 ns READ : Bank = 0 Row =   32, Col =   0, Data =   256
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206200.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206240.0 ns ACT  : Bank = 0 Row =   64
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206286.0 ns READ : Bank = 0 Row =   64, Col =   0, Data =   512
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206290.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206330.0 ns ACT  : Bank = 0 Row =   64
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206376.0 ns READ : Bank = 0 Row =   64, Col =   0, Data =   512
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206380.0 ns NOTE : Start Internal Auto Precharge for Bank 0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206420.0 ns ACT  : Bank = 3 Row =    0
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  206450.0 ns WRITE: Bank = 3 Row =    0, Col =   0, Data =     5
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221050.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221050.0 ns ERROR: All banks must be Precharge before Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221166.0 ns READ : Bank = 3 Row =    0, Col =   0, Data =     5
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221210.0 ns WRITE: Bank = 3 Row =    0, Col =  16, Data =    12
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221270.0 ns WRITE: Bank = 3 Row =    0, Col =  16, Data =     6
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  221396.0 ns READ : Bank = 3 Row =    0, Col =  16, Data =     6
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  236050.0 ns AREF : Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  236050.0 ns ERROR: All banks must be Precharge before Auto Refresh
# KERNEL: sdram_controller_tb.sim_model_u2 : at time  236150.0 ns WRITE: Bank = 3 Row =    0, Col =   0, Data =    22
----------------------------------------------------------------------------------------------------      